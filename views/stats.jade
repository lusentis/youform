extends layout

block content
  .content

    .stats
      .pure-g

        .pure-u-1-3
          div(style='padding-right: 20px;')
            h2 Your info

            if !form.email_confirmed
              p Your email is not confirmed!<br>If you have not received the confirmation email: 
                a(href='/api/confirm/send-email/#{form._id}?token=#{form.token}') Resend confirmation email
            else
              p 
                | Your email (
                small
                  em #{form.form_destination}
                | ) was previously confirmed! 
                br
                sub 
                  em Well done dude!

            br

            if !form.phone_confirmed
              p Your phone is not confirmed!<br>If you have not received the confirmation SMS: 
                a(href='/api/confirm/send-sms/#{form._id}?token=#{form.token}') Resend confirmation SMS
            else
              p 
                | Your phone (
                small
                  em +#{form.country_code} #{form.phone}
                | ) was previously confirmed! 
                br
                sub 
                  em Awww yeah!
        
        .pure-u-2-3
          div(style='padding-left: 20px;')
            h2 Your form

            p API KEY: #{form._id}
            p Form: #{form.form_name}
            if form.deleted === true
              p This form has been deleted.
            else
              p Website: 
                a(href=form.website_url) #{form.website_url}
              p Date: #{form.created_at}

              p Total requests: #{stats.total_rows}

              for row, year in stats.counter
                h5 Year: #{year}
                for value, month in row
                  p 
                    span.month-name 
                      | #{month}: 
                    span.month-value
                      | #{value}

              a.pure-button.pure-button-primary(href='/edit-form/#{form._id}?token=#{form.token}') Edit form
              | &nbsp;
              a.pure-button.pure-button-danger(href='/delete-form/#{form._id}?token=#{form.token}') Delete form
                  
block scripts
  script(type='text/javascript', src='/js/vendor/moment.min.js')
  script.
    Array.prototype.forEach.call(document.querySelectorAll('.month-name'), function (el) {      
      var monthNumber = parseInt(el.innerHTML, 10);
      el.innerHTML = moment().month(monthNumber - 1).format('MMMM') + ': ';
    });